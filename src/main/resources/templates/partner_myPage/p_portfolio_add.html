<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <!-- Bootstrap icons-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
    <!-- Google fonts-->
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link href="https://fonts.googleapis.com/css2?family=Newsreader:ital,wght@0,600;1,600&amp;display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,300;0,500;0,600;0,700;1,300;1,500;1,600;1,700&amp;display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,400;1,400&amp;display=swap" rel="stylesheet" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="../../css/main.css" rel="stylesheet" />
    <link href="../../css/p_myPage.css" rel="stylesheet" />
    <title>포트폴리오 관리</title>
</head>
<body>
    <!-- Header -->
    <div id="header"></div>

    <div class="wrapper">
        <div class="mypage_container">
            <div class="sidebar_content">
                <div class="profile_box items-center">
                    <div class="user_img_box"><a href="img"></a></div>
                    <button class="grade">등급</button>
                    <div class="user_text">
                        <h2>유저아이디</h2>
                        <p>user1@naver.com</p>
                    </div>
                </div>
                 <!-- Sidebar -->
                <div class="sidebar_menu">
                  <ul class="mt-8 space-y-4">
                      <li>    
                          <a href="p_myPage.html" class="flex justify-between items-center textdeco">
                              <span>개인정보 관리</span>
                              <span>&gt;</span>
                          </a>
                      </li>
                      <li>
                          <a href="p_project.html"  class="flex justify-between items-center textdeco">
                              <span>프로젝트 관리</span>
                              <span>&gt;</span>
                          </a>
                      </li>
                      <li>
                          <a href="p_skill.html"  class="flex justify-between items-center textdeco">
                              <span>보유기술 관리</span>
                              <span>&gt;</span>
                          </a>
                      </li>
                      <li class="current-page">
                          <a href="p_portfolio.html"  class="flex justify-between items-center textdeco">
                              <span>포트폴리오 관리</span>
                              <span>&gt;</span>
                          </a>
                      </li>
                      <li>
                          <a href="p_history.html" class="flex justify-between items-center textdeco">
                              <span>경력 관리</span>
                              <span>&gt;</span>
                          </a>
                      </li>
                      <li>
                          <a href="p_education.html" class="flex justify-between items-center textdeco">
                              <span>학력 관리</span>
                              <span>&gt;</span>
                          </a>
                      </li>
                      <li>
                          <a href="p_certificate.html" class="flex justify-between items-center textdeco">
                              <span>자격증 관리</span>
                              <span>&gt;</span>
                          </a>
                      </li>
                      <li>
                        <a href="p_account.html" class="flex justify-between items-center textdeco">
                            <span>계좌 관리</span>
                            <span>&gt;</span>
                        </a>
                    </li>
                  </ul>
              </div> 
          </div>

            <!-- Main Content -->
            <div class="content">
                <div class="section">
                    <h3>포트폴리오 추가</h3>
                    <form id="portfolioForm">
                        <label for="portfolioTitle"></label>
                        <input type="text" id="portfolioTitle" class="input_field" placeholder="포트폴리오 제목을 입력하세요" required>
            
                        <label for="portfolioDescription"></label>
                        <textarea id="portfolioDescription" class="input_field" placeholder="포트폴리오 내용을 입력하세요" required></textarea>
            
                        <input type="file" id="portfolioImage" class="file-input" accept="image/*" multiple>

                        <!-- 이미지 미리보기 영역 -->
                        <div id="imagePreviewContainer"></div>
            
                        <button type="submit" class="btn save_btn">저장하기</button>
                    </form>
                </div>
            </div>
        
        </div>
    </div> <!-- wrapper -->

     
  <!-- footer -->
  <div id="footer"></div>
  <script src="../../js/header_footer.js"></script>
  <script src="../../js/script.js"></script> 
  
  <script>
    // 업로드한 파일을 저장하는 배열 (기존 이미지 유지)
let uploadedFiles = [];

document.getElementById("portfolioImage").addEventListener("change", function(event) {
    let imagePreviewContainer = document.getElementById("imagePreviewContainer");
    
    // 새로운 파일 가져오기
    let newFiles = Array.from(event.target.files);

    // 기존 파일 + 새로운 파일 추가
    uploadedFiles = uploadedFiles.concat(newFiles);

    // 기존 미리보기를 유지하면서 새로운 이미지 추가
    uploadedFiles.forEach((file, index) => {
        // 중복된 이미지가 추가되지 않도록 기존 미리보기 확인
        if (!imagePreviewContainer.querySelector(`[data-index="${index}"]`)) {
            let reader = new FileReader();

            reader.onload = function(e) {
                let imageItem = document.createElement("div");
                imageItem.classList.add("image-item");
                imageItem.setAttribute("data-index", index);

                imageItem.innerHTML = `
                    <img src="${e.target.result}" class="preview-image">
                    <button class="delete-img-btn" onclick="removeImage(${index})">X</button>
                `;

                imagePreviewContainer.appendChild(imageItem);
            };

            reader.readAsDataURL(file);
        }
    });

    // input 요소의 파일 리스트 업데이트 (새 FileList 생성 필요)
    let dataTransfer = new DataTransfer();
    uploadedFiles.forEach(file => dataTransfer.items.add(file));
    document.getElementById("portfolioImage").files = dataTransfer.files;
});

function removeImage(index) {
    // 이미지 리스트에서 해당 이미지 제거
    uploadedFiles.splice(index, 1);

    // 미리보기에서 제거
    let imageItem = document.querySelector(`[data-index="${index}"]`);
    if (imageItem) {
        imageItem.remove();
    }

    // input 요소의 파일 리스트 업데이트 (새 FileList 생성 필요)
    let dataTransfer = new DataTransfer();
    uploadedFiles.forEach(file => dataTransfer.items.add(file));
    document.getElementById("portfolioImage").files = dataTransfer.files;
}

    </script>
    
</body>
</html>